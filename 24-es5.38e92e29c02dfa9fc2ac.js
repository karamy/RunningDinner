(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{QJOm:function(n,l,t){"use strict";t.r(l);var o=t("8Y7J");class e{}var u=t("pMnS"),a=t("MKJQ"),s=t("sZkV"),r=t("iInd"),i=t("SVse"),c=t("mrSG"),b=t("q/sB"),p=t("Mv9M"),m=t("BV2u"),h=t("IheW"),g=t("cUpR");class d{constructor(){}}let f=(()=>{class n{constructor(n,l,t,o,e){this.http=n,this.contacts=l,this.sanitizer=t,this.platform=o,this.rdConstants=e}getLocalContacts(n){return new Promise((l,t)=>{if(this.platform.is("cordova")){const o=[];this.contacts.find(["displayName","phoneNumbers","photos"]).then(e=>{if(0===e.length)console.warn("No contacts found"),t();else{for(let n=0;n<e.length;n++)if(null!==e[n].name){const l=new d;l.name=e[n].name.formatted,null!==e[n].phoneNumbers&&(l.phoneNumber=e[n].phoneNumbers[0].value.replace(/\s+/g,"")),l.imageUrl=null!==e[n].photos?this.sanitizer.bypassSecurityTrustUrl(window.Ionic.WebView.convertFileSrc(e[n].photos[0].value)):"assets/dummy.png",o.push(l)}if(n){const n=Array.from(new Set(o.map(n=>n.phoneNumber))).map(n=>o.find(l=>l.phoneNumber===n));l(n)}else l(o)}})}else l([{name:"Paolo",phoneNumber:"+393483773819",imageUrl:"assets/Logo.png"},{name:"Fringo",phoneNumber:"+393483773817",imageUrl:"assets/Logo.png"},{name:"Chiara",phoneNumber:"+393496824393",imageUrl:"assets/Logo.png"},{name:"Carlo",phoneNumber:"+393408552105",imageUrl:"assets/dummy.png"},{name:"Pange",phoneNumber:"+393495339159",imageUrl:"assets/dummy.png"},{name:"Ale",phoneNumber:"+393460500674",imageUrl:"assets/dummy.png"},{name:"Emulatore",phoneNumber:"+391234567890",imageUrl:"assets/dummy.png"}])})}postContacts(n){return new Promise((l,t)=>{this.http.post(this.rdConstants.getApiRoute("compareContacts"),n).subscribe(n=>{l(n)},n=>{console.warn(n),t()})})}compareContacts(n,l){let t=[];for(let o=0;o<l.length;o++)for(let e=0;e<n.length;e++)n[e].phoneNumber===l[o].phoneNumber&&(l[o].imageUrl="data:image/png;base64,"+n[e].imageUrl,t.push(l[o]));return t=t.sort((n,l)=>n.name.localeCompare(l.name)),t}}return n.ngInjectableDef=o.Jb({factory:function(){return new n(o.Kb(h.c),o.Kb(p.a),o.Kb(g.b),o.Kb(s.Eb),o.Kb(m.a))},token:n,providedIn:"root"}),n})();class k{constructor(n,l){this.modalController=n,this.contactsService=l,this.contactList=[]}showContact(n,l){return c.__awaiter(this,void 0,void 0,(function*(){const t=yield this.modalController.create({component:b.a,swipeToClose:!0,backdropDismiss:!0,componentProps:{contactName:n,contactImage:l},cssClass:"modal-style"});return yield t.present()}))}ngOnInit(){this.contactsService.getLocalContacts(!0).then(n=>{this.contactsService.postContacts(n).then(l=>{this.contactList=this.contactsService.compareContacts(l,n)},()=>{console.error("Impossibile inviare contatti al server")})},()=>{console.error("Impossibile leggere contatti dal dispositivo")})}}var C=o.nb({encapsulation:0,styles:[[""]],data:{}});function v(n){return o.Gb(0,[(n()(),o.pb(0,0,null,null,6,"ion-item",[],null,[[null,"click"]],(function(n,l,t){var o=!0;return"click"===l&&(o=!1!==n.component.showContact(n.context.$implicit.name,n.context.$implicit.imageUrl)&&o),o}),a.Q,a.p)),o.ob(1,49152,null,0,s.F,[o.h,o.k,o.x],null,null),(n()(),o.pb(2,0,null,0,2,"ion-avatar",[],null,null,null,a.C,a.b)),o.ob(3,49152,null,0,s.d,[o.h,o.k,o.x],null,null),(n()(),o.pb(4,0,null,0,0,"img",[],[[8,"src",4]],null,null,null,null)),(n()(),o.pb(5,0,null,0,1,"p",[],null,null,null,null,null)),(n()(),o.Fb(6,null,["",""]))],null,(function(n,l){n(l,4,0,l.context.$implicit.imageUrl),n(l,6,0,l.context.$implicit.name)}))}function N(n){return o.Gb(0,[(n()(),o.pb(0,0,null,null,14,"ion-header",[],null,null,null,a.M,a.l)),o.ob(1,49152,null,0,s.z,[o.h,o.k,o.x],null,null),(n()(),o.pb(2,0,null,0,12,"ion-toolbar",[],null,null,null,a.bb,a.A)),o.ob(3,49152,null,0,s.xb,[o.h,o.k,o.x],null,null),(n()(),o.pb(4,0,null,0,2,"ion-title",[],null,null,null,a.ab,a.z)),o.ob(5,49152,null,0,s.vb,[o.h,o.k,o.x],null,null),(n()(),o.Fb(-1,0,["contacts"])),(n()(),o.pb(7,0,null,0,7,"ion-buttons",[["slot","primary"]],null,null,null,a.F,a.e)),o.ob(8,49152,null,0,s.j,[o.h,o.k,o.x],null,null),(n()(),o.pb(9,0,null,0,5,"ion-button",[["routerLink","/home/profile"]],null,[[null,"click"]],(function(n,l,t){var e=!0;return"click"===l&&(e=!1!==o.Bb(n,11).onClick()&&e),"click"===l&&(e=!1!==o.Bb(n,12).onClick(t)&&e),e}),a.E,a.d)),o.ob(10,49152,null,0,s.i,[o.h,o.k,o.x],null,null),o.ob(11,16384,null,0,r.n,[r.m,r.a,[8,null],o.B,o.k],{routerLink:[0,"routerLink"]},null),o.ob(12,737280,null,0,s.Gb,[i.g,s.Db,o.k,r.m,[2,r.n]],null,null),(n()(),o.pb(13,0,null,0,1,"ion-icon",[["name","person-circle-outline"],["slot","icon-only"]],null,null,null,a.N,a.m)),o.ob(14,49152,null,0,s.A,[o.h,o.k,o.x],{name:[0,"name"]},null),(n()(),o.pb(15,0,null,null,5,"ion-content",[],null,null,null,a.I,a.h)),o.ob(16,49152,null,0,s.s,[o.h,o.k,o.x],null,null),(n()(),o.pb(17,0,null,0,3,"ion-list",[],null,null,null,a.S,a.r)),o.ob(18,49152,null,0,s.M,[o.h,o.k,o.x],null,null),(n()(),o.eb(16777216,null,0,1,null,v)),o.ob(20,278528,null,0,i.h,[o.M,o.J,o.q],{ngForOf:[0,"ngForOf"]},null)],(function(n,l){var t=l.component;n(l,11,0,"/home/profile"),n(l,12,0),n(l,14,0,"person-circle-outline"),n(l,20,0,t.contactList)}),null)}var w=o.lb("app-contacts",k,(function(n){return o.Gb(0,[(n()(),o.pb(0,0,null,null,1,"app-contacts",[],null,null,null,N,C)),o.ob(1,114688,null,0,k,[s.Cb,f],null,null)],(function(n,l){n(l,1,0)}),null)}),{},{},[]),z=t("s7LF");const y=()=>t.e(23).then(t.bind(null,"BixF")).then(n=>n.ContactsDetailPageModuleNgFactory);class x{}t.d(l,"ContactsPageModuleNgFactory",(function(){return F}));var F=o.mb(e,[],(function(n){return o.yb([o.zb(512,o.j,o.X,[[8,[u.a,w]],[3,o.j],o.v]),o.zb(4608,i.k,i.j,[o.s,[2,i.q]]),o.zb(4608,z.i,z.i,[]),o.zb(4608,s.a,s.a,[o.x,o.g]),o.zb(4608,s.Cb,s.Cb,[s.a,o.j,o.p]),o.zb(4608,s.Fb,s.Fb,[s.a,o.j,o.p]),o.zb(1073742336,i.b,i.b,[]),o.zb(1073742336,z.h,z.h,[]),o.zb(1073742336,z.a,z.a,[]),o.zb(1073742336,s.zb,s.zb,[]),o.zb(1073742336,r.o,r.o,[[2,r.t],[2,r.m]]),o.zb(1073742336,x,x,[]),o.zb(1073742336,e,e,[]),o.zb(1024,r.k,(function(){return[[{path:"",component:k},{path:"contacts-detail",loadChildren:y}]]}),[])])}))}}]);