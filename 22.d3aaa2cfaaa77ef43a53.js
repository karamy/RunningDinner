(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{QJOm:function(n,l,e){"use strict";e.r(l);var t=e("CcnG"),o=function(){return function(){}}(),u=e("pMnS"),i=e("MKJQ"),r=e("jy/b"),c=e("Ip0R"),a=e("L0Zc"),s=e("9B5/"),d=e("yzu5"),f=e("mrSG"),m=e("iO+n"),p=e("8ld7"),g=e("DP//"),h=e("qXBG"),R=e("Ds5d"),b=function(){function n(n,l,e,t,o){this.modalController=n,this.contactsService=l,this.spinner=e,this.authService=t,this.rdToast=o,this.contactList=[],this.modalOpen=!1}return n.prototype.ngOnInit=function(){this.loadContacts()},n.prototype.doRefresh=function(n){return f.__awaiter(this,void 0,void 0,(function(){return f.__generator(this,(function(l){switch(l.label){case 0:return[4,this.contactsService.clearLocalContacts()];case 1:return l.sent(),[4,this.contactsService.clearMatchingContacts()];case 2:return l.sent(),this.loadContacts().finally((function(){n.target.complete()})),[2]}}))}))},n.prototype.loadContacts=function(){var n=this;return this.syncInProgress=!0,new Promise((function(l,e){n.contactsService.getLocalContacts(!0,n.authService.getUserData().phone_number).then((function(t){n.contactsService.getMatchingContacts(t).then((function(e){var o=n.contactList;n.contactList=n.contactsService.compareContacts(e,t),o.length!==n.contactList.length&&n.showToast(o),n.syncInProgress=!1,l()}),(function(){n.syncInProgress=!1,console.error("Impossibile inviare contatti al server"),e()}))}),(function(){n.syncInProgress=!1,console.error("Impossibile leggere contatti dal dispositivo"),e()}))}))},n.prototype.onShowContact=function(n,l,e,t){return f.__awaiter(this,void 0,void 0,(function(){var o,u=this;return f.__generator(this,(function(i){switch(i.label){case 0:return this.modalOpen=!0,[4,this.modalController.create({component:m.a,swipeToClose:!0,backdropDismiss:!0,componentProps:{contactName:n,contactImage:l,contactId:e,isInGroup:t},cssClass:"modal-style"})];case 1:return(o=i.sent()).onWillDismiss().then((function(){u.modalOpen=!1})),[4,o.present()];case 2:return[2,i.sent()]}}))}))},n.prototype.showToast=function(n){var l,e=this.contactList.length-n.length;l=e>0?e>1?"Aggiunti "+e+" contatti":"Aggiunto "+e+" contatto":e<-1?"Rimossi "+Math.abs(e)+" contatti":"Rimosso "+Math.abs(e)+" contatto",this.rdToast.show(l)},n}(),C=t["ɵcrt"]({encapsulation:0,styles:[[".blur[_ngcontent-%COMP%]{-webkit-filter:blur(5px);filter:blur(5px)}"]],data:{}});function v(n){return t["ɵvid"](0,[(n()(),t["ɵeld"](0,0,null,null,6,"ion-item",[],null,[[null,"click"]],(function(n,l,e){var t=!0;return"click"===l&&(t=!1!==n.component.onShowContact(n.context.$implicit.name,n.context.$implicit.imageUrl,n.context.$implicit.userId,n.context.$implicit.isInGroup)&&t),t}),i.nb,i.u)),t["ɵdid"](1,49152,null,0,r.G,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](2,0,null,0,2,"ion-avatar",[],null,null,null,i.R,i.b)),t["ɵdid"](3,49152,null,0,r.e,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](4,0,null,0,0,"img",[],[[8,"src",4]],null,null,null,null)),(n()(),t["ɵeld"](5,0,null,0,1,"p",[],null,null,null,null,null)),(n()(),t["ɵted"](6,null,["",""]))],null,(function(n,l){n(l,4,0,l.context.$implicit.imageUrl),n(l,6,0,l.context.$implicit.name)}))}function I(n){return t["ɵvid"](0,[(n()(),t["ɵeld"](0,0,null,null,3,"ion-list",[],null,null,null,i.pb,i.z)),t["ɵdid"](1,49152,null,0,r.N,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵand"](16777216,null,0,1,null,v)),t["ɵdid"](3,278528,null,0,c.NgForOf,[t.ViewContainerRef,t.TemplateRef,t.IterableDiffers],{ngForOf:[0,"ngForOf"]},null)],(function(n,l){n(l,3,0,l.component.contactList)}),null)}function N(n){return t["ɵvid"](0,[(n()(),t["ɵeld"](0,0,null,null,7,"ion-item",[],null,null,null,i.nb,i.u)),t["ɵdid"](1,49152,null,0,r.G,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](2,0,null,0,3,"ion-avatar",[["style","margin-top: 0.5em; margin-bottom: 0.5em;"]],null,null,null,i.R,i.b)),t["ɵdid"](3,49152,null,0,r.e,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](4,0,null,0,1,"ion-skeleton-text",[["animated",""]],null,null,null,i.xb,i.H)),t["ɵdid"](5,49152,null,0,r.lb,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],{animated:[0,"animated"]},null),(n()(),t["ɵeld"](6,0,null,0,1,"ion-skeleton-text",[["animated",""],["style","width: 20%; margin-left: 0.2em;"]],null,null,null,i.xb,i.H)),t["ɵdid"](7,49152,null,0,r.lb,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],{animated:[0,"animated"]},null)],(function(n,l){n(l,5,0,""),n(l,7,0,"")}),null)}function y(n){return t["ɵvid"](0,[(n()(),t["ɵeld"](0,0,null,null,4,"ion-list",[],null,null,null,i.pb,i.z)),t["ɵdid"](1,49152,null,0,r.N,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵand"](16777216,null,0,2,null,N)),t["ɵdid"](3,278528,null,0,c.NgForOf,[t.ViewContainerRef,t.TemplateRef,t.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),t["ɵpad"](4,8)],(function(n,l){var e=n(l,4,0,0,1,2,3,4,5,6,7);n(l,3,0,e)}),null)}function D(n){return t["ɵvid"](0,[(n()(),t["ɵeld"](0,0,null,null,10,"ion-header",[],null,null,null,i.eb,i.o)),t["ɵdid"](1,49152,null,0,r.A,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](2,0,null,0,8,"ion-toolbar",[],null,null,null,i.Fb,i.P)),t["ɵdid"](3,49152,null,0,r.yb,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](4,0,null,0,2,"ion-title",[],null,null,null,i.Eb,i.O)),t["ɵdid"](5,49152,null,0,r.wb,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵted"](-1,0,["contacts"])),(n()(),t["ɵeld"](7,0,null,0,3,"ion-buttons",[["slot","primary"]],null,null,null,i.U,i.e)),t["ɵdid"](8,49152,null,0,r.k,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](9,0,null,0,1,"rd-profile",[],null,null,null,a.b,a.a)),t["ɵdid"](10,114688,null,0,s.a,[d.a],null,null),(n()(),t["ɵeld"](11,0,null,null,9,"ion-content",[],[[2,"blur",null]],null,null,i.ab,i.k)),t["ɵdid"](12,49152,null,0,r.t,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](13,0,null,0,3,"ion-refresher",[["slot","fixed"]],null,[[null,"ionRefresh"]],(function(n,l,e){var t=!0;return"ionRefresh"===l&&(t=!1!==n.component.doRefresh(e)&&t),t}),i.sb,i.B)),t["ɵdid"](14,49152,null,0,r.Z,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](15,0,null,0,1,"ion-refresher-content",[["pullingIcon","lines"],["refreshingSpinner","lines"]],null,null,null,i.rb,i.C)),t["ɵdid"](16,49152,null,0,r.ab,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],{pullingIcon:[0,"pullingIcon"],refreshingSpinner:[1,"refreshingSpinner"]},null),(n()(),t["ɵand"](16777216,null,0,1,null,I)),t["ɵdid"](18,16384,null,0,c.NgIf,[t.ViewContainerRef,t.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),t["ɵand"](16777216,null,0,1,null,y)),t["ɵdid"](20,16384,null,0,c.NgIf,[t.ViewContainerRef,t.TemplateRef],{ngIf:[0,"ngIf"]},null)],(function(n,l){var e=l.component;n(l,10,0),n(l,16,0,"lines","lines"),n(l,18,0,!e.syncInProgress),n(l,20,0,e.syncInProgress)}),(function(n,l){n(l,11,0,!0===l.component.modalOpen)}))}function w(n){return t["ɵvid"](0,[(n()(),t["ɵeld"](0,0,null,null,1,"app-contacts",[],null,null,null,D,C)),t["ɵdid"](1,114688,null,0,b,[r.Db,p.a,g.a,h.a,R.a],null,null)],(function(n,l){n(l,1,0)}),null)}var Z=t["ɵccf"]("app-contacts",b,w,{},{},[]),E=e("gIcY"),O=e("ZYCi"),S=function(){return function(){}}(),_=e("RnAK"),L=e("E9nr");e.d(l,"ContactsPageModuleNgFactory",(function(){return k}));var k=t["ɵcmf"](o,[],(function(n){return t["ɵmod"]([t["ɵmpd"](512,t.ComponentFactoryResolver,t["ɵCodegenComponentFactoryResolver"],[[8,[u.a,Z]],[3,t.ComponentFactoryResolver],t.NgModuleRef]),t["ɵmpd"](4608,c.NgLocalization,c.NgLocaleLocalization,[t.LOCALE_ID,[2,c["ɵangular_packages_common_common_a"]]]),t["ɵmpd"](4608,E.l,E.l,[]),t["ɵmpd"](4608,r.b,r.b,[t.NgZone,t.ApplicationRef]),t["ɵmpd"](4608,r.Db,r.Db,[r.b,t.ComponentFactoryResolver,t.Injector]),t["ɵmpd"](4608,r.Gb,r.Gb,[r.b,t.ComponentFactoryResolver,t.Injector]),t["ɵmpd"](1073742336,c.CommonModule,c.CommonModule,[]),t["ɵmpd"](1073742336,E.k,E.k,[]),t["ɵmpd"](1073742336,E.b,E.b,[]),t["ɵmpd"](1073742336,r.Ab,r.Ab,[]),t["ɵmpd"](1073742336,O.p,O.p,[[2,O.u],[2,O.n]]),t["ɵmpd"](1073742336,S,S,[]),t["ɵmpd"](1073742336,_.a,_.a,[]),t["ɵmpd"](1073742336,L.a,L.a,[]),t["ɵmpd"](1073742336,o,o,[]),t["ɵmpd"](1024,O.l,(function(){return[[{path:"",component:b}]]}),[])])}))}}]);