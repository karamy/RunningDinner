(window.webpackJsonp=window.webpackJsonp||[]).push([[105],{kUTz:function(n,l,e){"use strict";e.r(l);var t=e("CcnG"),u=function(){return function(){}}(),o=e("pMnS"),i=e("MKJQ"),a=e("jy/b"),s=e("Ip0R"),r=e("L0Zc"),d=e("9B5/"),c=e("yzu5"),g=e("gIcY"),p=e("qXBG"),m=e("0+Dt"),f=e("nfF7"),h=e("98RE"),b=function(){function n(n,l,e,t){this.chatService=n,this.authService=l,this.profileService=e,this.notificationService=t,this.dinnerMessages=[]}return n.prototype.ngOnInit=function(){var n=this;this.user=this.authService.getUserData(),this.messagesSubscription=this.chatService.init().subscribe((function(l){n.handleNewMessages(l)})),this.notificationService.getUpdateParamsObservable().subscribe((function(){console.log("Chat - Ricarico parametri e messaggi"),n.dinnerMessages=[],n.messagesSubscription.unsubscribe(),n.messagesSubscription=n.chatService.init().subscribe((function(l){n.handleNewMessages(l)}))}))},n.prototype.handleNewMessages=function(n){0==this.dinnerMessages.length&&this.scrollToBottom(),this.dinnerMessages=this.dinnerMessages.concat(n)},n.prototype.sendMsg=function(){var n=this;this.newMsgText&&this.chatService.addNewMessage(this.newMsgText).then((function(){n.scrollToBottom(),n.newMsgText=""}))},n.prototype.scrollToBottom=function(){var n=this;setTimeout((function(){n.chatContent.scrollToBottom()}))},n}(),v=t["ɵcrt"]({encapsulation:0,styles:[['body[_ngcontent-%COMP%]{font-family:Ubuntu-Italic,"Lucida Sans",helvetica,sans}.newmsg[_ngcontent-%COMP%]{display:inline-block;width:60%}ion-icon[_ngcontent-%COMP%]{font-size:1.5em;color:#9cc7ae}.footer-button[_ngcontent-%COMP%]{float:right}#chatContent[_ngcontent-%COMP%]{opacity:0;margin-top:30px;width:290px;height:270px;overflow-y:scroll;overflow-x:hidden;padding-right:20px;-webkit-transition:.2s cubic-bezier(0,.995,.99,1);transition:all .2s cubic-bezier(0,.995,.99,1)}div.message[_ngcontent-%COMP%]{padding:0 0 30px 40px;clear:both;margin-bottom:10px}div.message.right[_ngcontent-%COMP%]{padding:0 50px 30px 0;margin-left:auto}.message[_ngcontent-%COMP%]   .bubble[_ngcontent-%COMP%]{background:#f0f4f7;font-size:13px;font-weight:600;padding:12px 13px;border-radius:5px 5px 5px 0;color:#8495a3;position:relative;min-width:50px}div.message.right[_ngcontent-%COMP%]   .bubble[_ngcontent-%COMP%]{float:right;border-radius:5px 5px 0}.bubble[_ngcontent-%COMP%]   .corner[_ngcontent-%COMP%]{background:url(https://s3-us-west-2.amazonaws.com/s.cdpn.io/245657/bubble-corner.png) no-repeat;position:absolute;width:7px;height:7px;left:-5px;bottom:0}div.message.right[_ngcontent-%COMP%]   .corner[_ngcontent-%COMP%]{background:url(https://s3-us-west-2.amazonaws.com/s.cdpn.io/245657/bubble-cornerR.png) no-repeat;left:auto;right:-5px}.bubble[_ngcontent-%COMP%]   span.time[_ngcontent-%COMP%]{color:#aab8c2;font-size:11px;position:absolute;right:0;bottom:-22px}ion-avatar[_ngcontent-%COMP%]{float:left;margin-left:-38px;width:35px;height:35px;border:3px solid #9cc7ae}div.message.right[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{float:right;margin-left:0;margin-right:-38px}']],data:{}});function C(n){return t["ɵvid"](0,[(n()(),t["ɵeld"](0,0,null,null,11,"div",[["class","message"]],null,null,null,null,null)),(n()(),t["ɵeld"](1,0,null,null,2,"ion-avatar",[],null,null,null,i.O,i.b)),t["ɵdid"](2,49152,null,0,a.e,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](3,0,null,0,0,"img",[],[[8,"src",4]],null,null,null,null)),(n()(),t["ɵeld"](4,0,null,null,7,"div",[["class","bubble"]],null,null,null,null,null)),(n()(),t["ɵeld"](5,0,null,null,1,"span",[["style","color: lightcoral"]],null,null,null,null,null)),(n()(),t["ɵted"](6,null,["",""])),(n()(),t["ɵeld"](7,0,null,null,0,"br",[],null,null,null,null,null)),(n()(),t["ɵted"](8,null,[" "," "])),(n()(),t["ɵeld"](9,0,null,null,0,"div",[["class","corner"]],null,null,null,null,null)),(n()(),t["ɵeld"](10,0,null,null,1,"span",[["class","time"]],null,null,null,null,null)),(n()(),t["ɵted"](11,null,["",""]))],null,(function(n,l){n(l,3,0,l.component.user.profile_photo),n(l,6,0,l.parent.context.$implicit.sentby),n(l,8,0,l.parent.context.$implicit.message),n(l,11,0,l.parent.context.$implicit.timeofmsg)}))}function R(n){return t["ɵvid"](0,[(n()(),t["ɵeld"](0,0,null,null,11,"div",[["class","message right"]],null,null,null,null,null)),(n()(),t["ɵeld"](1,0,null,null,2,"ion-avatar",[],null,null,null,i.O,i.b)),t["ɵdid"](2,49152,null,0,a.e,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](3,0,null,0,0,"img",[],[[8,"src",4]],null,null,null,null)),(n()(),t["ɵeld"](4,0,null,null,7,"div",[["class","bubble"]],null,null,null,null,null)),(n()(),t["ɵeld"](5,0,null,null,1,"span",[["style","color: green"]],null,null,null,null,null)),(n()(),t["ɵted"](6,null,["",""])),(n()(),t["ɵeld"](7,0,null,null,0,"br",[],null,null,null,null,null)),(n()(),t["ɵted"](8,null,[" "," "])),(n()(),t["ɵeld"](9,0,null,null,0,"div",[["class","corner"]],null,null,null,null,null)),(n()(),t["ɵeld"](10,0,null,null,1,"span",[["class","time"]],null,null,null,null,null)),(n()(),t["ɵted"](11,null,["",""]))],null,(function(n,l){n(l,3,0,l.component.user.profile_photo),n(l,6,0,l.parent.context.$implicit.sentby),n(l,8,0,l.parent.context.$implicit.message),n(l,11,0,l.parent.context.$implicit.timeofmsg)}))}function M(n){return t["ɵvid"](0,[(n()(),t["ɵeld"](0,0,null,null,5,"ion-item",[["text-wrap",""]],null,null,null,i.jb,i.s)),t["ɵdid"](1,49152,null,0,a.G,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵand"](16777216,null,0,1,null,C)),t["ɵdid"](3,16384,null,0,s.NgIf,[t.ViewContainerRef,t.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),t["ɵand"](16777216,null,0,1,null,R)),t["ɵdid"](5,16384,null,0,s.NgIf,[t.ViewContainerRef,t.TemplateRef],{ngIf:[0,"ngIf"]},null)],(function(n,l){var e=l.component;n(l,3,0,l.context.$implicit.sentby!=e.user.name),n(l,5,0,l.context.$implicit.sentby===e.user.name)}),null)}function x(n){return t["ɵvid"](0,[t["ɵqud"](671088640,1,{chatContent:0}),(n()(),t["ɵeld"](1,0,null,null,15,"ion-header",[],null,null,null,i.bb,i.o)),t["ɵdid"](2,49152,null,0,a.A,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](3,0,null,0,13,"ion-toolbar",[],null,null,null,i.zb,i.M)),t["ɵdid"](4,49152,null,0,a.yb,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](5,0,null,0,4,"ion-buttons",[["slot","start"]],null,null,null,i.R,i.e)),t["ɵdid"](6,49152,null,0,a.k,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](7,0,null,0,2,"ion-back-button",[["defaultHref","/home/tabs/dinner-history"]],null,[[null,"click"]],(function(n,l,e){var u=!0;return"click"===l&&(u=!1!==t["ɵnov"](n,9).onClick(e)&&u),u}),i.P,i.c)),t["ɵdid"](8,49152,null,0,a.f,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],{defaultHref:[0,"defaultHref"]},null),t["ɵdid"](9,16384,null,0,a.g,[[2,a.eb],a.Eb],{defaultHref:[0,"defaultHref"]},null),(n()(),t["ɵeld"](10,0,null,0,2,"ion-title",[],null,null,null,i.yb,i.L)),t["ɵdid"](11,49152,null,0,a.wb,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵted"](-1,0,["chat"])),(n()(),t["ɵeld"](13,0,null,0,3,"ion-buttons",[["slot","primary"]],null,null,null,i.R,i.e)),t["ɵdid"](14,49152,null,0,a.k,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](15,0,null,0,1,"rd-profile",[],null,null,null,r.b,r.a)),t["ɵdid"](16,114688,null,0,d.a,[c.a],null,null),(n()(),t["ɵeld"](17,0,null,null,6,"ion-content",[],null,null,null,i.X,i.k)),t["ɵdid"](18,49152,[[1,4],["chatContent",4]],0,a.t,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](19,0,null,0,4,"div",[],null,null,null,null,null)),(n()(),t["ɵeld"](20,0,null,null,3,"ion-list",[["lines","none"]],null,null,null,i.lb,i.y)),t["ɵdid"](21,49152,null,0,a.N,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],{lines:[0,"lines"]},null),(n()(),t["ɵand"](16777216,null,0,1,null,M)),t["ɵdid"](23,278528,null,0,s.NgForOf,[t.ViewContainerRef,t.TemplateRef,t.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(n()(),t["ɵeld"](24,0,null,null,19,"ion-footer",[],null,null,null,i.Z,i.m)),t["ɵdid"](25,49152,null,0,a.y,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](26,0,null,0,17,"form",[["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"submit"],[null,"reset"]],(function(n,l,e){var u=!0;return"submit"===l&&(u=!1!==t["ɵnov"](n,28).onSubmit(e)&&u),"reset"===l&&(u=!1!==t["ɵnov"](n,28).onReset()&&u),u}),null,null)),t["ɵdid"](27,16384,null,0,g.m,[],null,null),t["ɵdid"](28,4210688,null,0,g.h,[[8,null],[8,null]],null,null),t["ɵprd"](2048,null,g.a,null,[g.h]),t["ɵdid"](30,16384,null,0,g.g,[[4,g.a]],null,null),(n()(),t["ɵeld"](31,0,null,null,12,"ion-toolbar",[],null,null,null,i.zb,i.M)),t["ɵdid"](32,49152,null,0,a.yb,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](33,0,null,0,6,"ion-input",[["class","newmsg"],["name","newmessage"],["placeholder","Write your message ..."]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"keyup.enter"],[null,"ionBlur"],[null,"ionChange"]],(function(n,l,e){var u=!0,o=n.component;return"ionBlur"===l&&(u=!1!==t["ɵnov"](n,34)._handleBlurEvent(e.target)&&u),"ionChange"===l&&(u=!1!==t["ɵnov"](n,34)._handleInputEvent(e.target)&&u),"ngModelChange"===l&&(u=!1!==(o.newMsgText=e)&&u),"keyup.enter"===l&&(u=!1!==o.sendMsg()&&u),u}),i.eb,i.r)),t["ɵdid"](34,16384,null,0,a.Jb,[t.ElementRef],null,null),t["ɵprd"](1024,null,g.d,(function(n){return[n]}),[a.Jb]),t["ɵdid"](36,671744,null,0,g.i,[[2,g.a],[8,null],[8,null],[6,g.d]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),t["ɵprd"](2048,null,g.e,null,[g.i]),t["ɵdid"](38,16384,null,0,g.f,[[4,g.e]],null,null),t["ɵdid"](39,49152,[["newmsg",4]],0,a.F,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],{name:[0,"name"],placeholder:[1,"placeholder"]},null),(n()(),t["ɵeld"](40,0,null,0,3,"ion-button",[["class","footer-button"]],[[8,"hidden",0]],[[null,"click"]],(function(n,l,e){var t=!0;return"click"===l&&(t=!1!==n.component.sendMsg()&&t),t}),i.Q,i.d)),t["ɵdid"](41,49152,null,0,a.j,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],null,null),(n()(),t["ɵeld"](42,0,null,0,1,"ion-icon",[["name","send-outline"],["slot","icon-only"]],null,null,null,i.cb,i.p)),t["ɵdid"](43,49152,null,0,a.B,[t.ChangeDetectorRef,t.ElementRef,t.NgZone],{name:[0,"name"]},null)],(function(n,l){var e=l.component;n(l,8,0,"/home/tabs/dinner-history"),n(l,9,0,"/home/tabs/dinner-history"),n(l,16,0),n(l,21,0,"none"),n(l,23,0,e.dinnerMessages),n(l,36,0,"newmessage",e.newMsgText),n(l,39,0,"newmessage","Write your message ..."),n(l,43,0,"send-outline")}),(function(n,l){var e=l.component;n(l,26,0,t["ɵnov"](l,30).ngClassUntouched,t["ɵnov"](l,30).ngClassTouched,t["ɵnov"](l,30).ngClassPristine,t["ɵnov"](l,30).ngClassDirty,t["ɵnov"](l,30).ngClassValid,t["ɵnov"](l,30).ngClassInvalid,t["ɵnov"](l,30).ngClassPending),n(l,33,0,t["ɵnov"](l,38).ngClassUntouched,t["ɵnov"](l,38).ngClassTouched,t["ɵnov"](l,38).ngClassPristine,t["ɵnov"](l,38).ngClassDirty,t["ɵnov"](l,38).ngClassValid,t["ɵnov"](l,38).ngClassInvalid,t["ɵnov"](l,38).ngClassPending),n(l,40,0,!e.newMsgText)}))}function y(n){return t["ɵvid"](0,[(n()(),t["ɵeld"](0,0,null,null,1,"app-chat",[],null,null,null,x,v)),t["ɵdid"](1,114688,null,0,b,[f.a,p.a,m.a,h.a],null,null)],(function(n,l){n(l,1,0)}),null)}var w=t["ɵccf"]("app-chat",b,y,{},{},[]),N=e("ZYCi"),_=function(){return function(){}}(),O=e("RnAK"),P=e("E9nr");e.d(l,"ChatPageModuleNgFactory",(function(){return D}));var D=t["ɵcmf"](u,[],(function(n){return t["ɵmod"]([t["ɵmpd"](512,t.ComponentFactoryResolver,t["ɵCodegenComponentFactoryResolver"],[[8,[o.a,w]],[3,t.ComponentFactoryResolver],t.NgModuleRef]),t["ɵmpd"](4608,s.NgLocalization,s.NgLocaleLocalization,[t.LOCALE_ID,[2,s["ɵangular_packages_common_common_a"]]]),t["ɵmpd"](4608,g.l,g.l,[]),t["ɵmpd"](4608,a.b,a.b,[t.NgZone,t.ApplicationRef]),t["ɵmpd"](4608,a.Db,a.Db,[a.b,t.ComponentFactoryResolver,t.Injector]),t["ɵmpd"](4608,a.Gb,a.Gb,[a.b,t.ComponentFactoryResolver,t.Injector]),t["ɵmpd"](1073742336,s.CommonModule,s.CommonModule,[]),t["ɵmpd"](1073742336,g.k,g.k,[]),t["ɵmpd"](1073742336,g.b,g.b,[]),t["ɵmpd"](1073742336,a.Ab,a.Ab,[]),t["ɵmpd"](1073742336,N.p,N.p,[[2,N.u],[2,N.n]]),t["ɵmpd"](1073742336,_,_,[]),t["ɵmpd"](1073742336,O.a,O.a,[]),t["ɵmpd"](1073742336,P.a,P.a,[]),t["ɵmpd"](1073742336,u,u,[]),t["ɵmpd"](1024,N.l,(function(){return[[{path:"",component:b}]]}),[])])}))}}]);